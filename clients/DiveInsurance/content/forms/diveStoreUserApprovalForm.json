{
	"_id": "5e3aab2b9493e5d0d0fe05c2",
	"type": "form",
	"tags": [],
	"owner": "5cd2e0d62363f67ddc9489c6",
	"components": [{
		"title": "Quote Information",
		"theme": "primary",
		"breadcrumb": "none",
		"breadcrumbClickable": true,
		"buttonSettings": {
			"previous": true,
			"cancel": true,
			"next": true
		},
		"collapsible": false,
		"tableView": false,
		"key": "page5Panel",
		"type": "panel",
		"label": "Quote Information",
		"input": false,
		"components": [{
			"type": "document",
			"key": "documents",
			"dtype": "document",
			"datype": "document",
			"dattype": "document",
			"datatype": "document",
			"data_type": "document",
			"label": "Documents",
			"hideLabel": true,
			"inputType": "document",
			"input": 1,
			"tableView": false
		}, {
			"type": "documentviewer",
			"key": "quoteDocuments",
			"label": "Quote Documents",
			"calculateValue": "value = (data['documents'])",
			"hideLabel": true,
			"inputType": "documentviewer",
			"input": 1,
			"refreshOn": "documents",
			"tableView": false,
			"protected": true,
			"persistent": false
		}, {
			"label": "orgId",
			"key": "orgId",
			"type": "hidden",
			"input": true,
			"tableView": false,
			"defaultValue": "f0033dc0-126b-40ba-89e0-d3061bdeda4c"
		}, {
			"label": "ApproverName",
			"calculateValue": "if (data.privileges){\n  if(data.privileges['MANAGE_POLICY_APPROVAL_WRITE'] !== null && data.privileges['MANAGE_POLICY_APPROVAL_WRITE']){\n    value = data['userprofile'].name;\n  }\n}",
			"key": "approverName",
			"type": "hidden",
			"input": true,
			"tableView": false,
			"hideOnChildrenHidden": false
		}, {
			"label": "ApproverEmailId",
			"calculateValue": "if (data.privileges){\n  if(data.privileges['MANAGE_POLICY_APPROVAL_WRITE'] !== null && data.privileges['MANAGE_POLICY_APPROVAL_WRITE']){\n    value = data['userprofile'].email;\n  }\n}",
			"key": "approverEmailId",
			"type": "hidden",
			"input": true,
			"tableView": false,
			"hideOnChildrenHidden": false
		}, {
			"label": "ApproverDesignation",
			"calculateValue": "if (data.privileges){\n  if(data.privileges['MANAGE_POLICY_APPROVAL_WRITE'] !== null && data.privileges['MANAGE_POLICY_APPROVAL_WRITE']){\n    value = data['userprofile'].designation;\n  }\n}",
			"key": "approverDesignation",
			"type": "hidden",
			"input": true,
			"tableView": false,
			"hideOnChildrenHidden": false
		}, {
			"label": "proposalCount",
			"defaultValue": "1",
			"key": "proposalCount",
			"type": "hidden",
			"input": true,
			"tableView": false
		}, {
			"label": "proposalCountFlag",
			"defaultValue": "false",
			"persistent": false,
			"protected": true,
			"key": "proposalCountFlag",
			"type": "hidden",
			"input": true,
			"tableView": false
		}, {
			"key": "page5Panel2",
			"input": false,
			"title": "Approval",
			"theme": "primary",
			"tableView": false,
			"components": [{
				"label": "well",
				"tableView": false,
				"key": "well4",
				"type": "well",
				"input": false,
				"components": [{
					"label": "I hereby declare that I accept the proposal",
					"optionsLabelPosition": "right",
					"inline": false,
					"tableView": true,
					"values": [{
						"value": "accepted",
						"label": "Accept",
						"shortcut": ""
					}, {
						"value": "rejected",
						"label": "Decline",
						"shortcut": ""
					}],
					"validate": {
						"required": true
					},
					"key": "userApproved",
					"properties": {
						"": "page7"
					},
					"type": "radio",
					"input": true,
					"lockKey": true
				}, {
					"label": "Could you let us know the Reason for Rejecting the Quote?",
					"autoExpand": false,
					"tableView": true,
					"validate": {
						"required": true
					},
					"key": "userRejectionReason",
					"conditional": {
						"show": true,
						"when": "userApproved",
						"eq": "false"
					},
					"type": "textarea",
					"input": true
				}],
				"path": "well4",
				"clearOnHide": false,
				"hideLabel": true
			}],
			"type": "panel",
			"lockKey": true,
			"label": "Panel",
			"path": "page5Panel2"
		}, {
			"title": "Attachments",
			"theme": "primary",
			"collapsible": false,
			"tableView": false,
			"key": "csrAttachmentsPanel",
			"type": "panel",
			"label": "Attachments",
			"input": false,
			"components": [{
				"label": "Attachments",
				"hideLabel": true,
				"tableView": true,
				"storage": "url",
				"webcam": true,
				"fileTypes": [{
					"label": "",
					"value": ""
				}],
				"filePattern": ".pdf,.png,.jpeg,.jpg,.gif,.doc,.docx,.xlsx,.xls,.txt,.pst,.ost,.msg",
				"fileMaxSize": "10MB",
				"multiple": true,
				"clearOnHide": false,
				"validate": {
					"custom": "show = (!data.csrApprovalAttachments || typeof(data.csrApprovalAttachments) != 'string')",
					"multiple": true
				},
				"key": "csrApprovalAttachments",
				"type": "file",
				"url": "/file/attachment",
				"input": true
			}]
		}, {
			"title": "Payment Information",
			"theme": "primary",
			"collapsible": false,
			"tableView": false,
			"key": "page7",
			"properties": {
				"payment_confirmation_page": "true"
			},
			"customConditional": "show = (data.userApproved == \"accepted\" && parseFloat(data.totalAmount) > 0)",
			"type": "panel",
			"label": "Payment Information",
			"breadcrumb": "none",
			"buttonSettings": {
				"previous": true,
				"cancel": true,
				"next": true
			},
			"components": [{
				"label": "payment",
				"calculateValue": "value = 'true';",
				"key": "payment",
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"label": "automatic_renewal",
				"customDefaultValue": "value = false;",
				"key": "automatic_renewal",
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"label": "amountPayable",
				"calculateValue": "if(data.premiumFinanceSelect == 'yes'){\n  var month =moment(data.start_date).month() +1;\n  var day = moment(data.start_date).format('DD');\n  if((day == 30 && month == 6) || month == 7){\n    value = (parseFloat(data.totalAmount).toFixed(2))*25/100;\n    data.paymentInstallments = 6;\n  } else if(month == 8){\n    value = (parseFloat(data.totalAmount).toFixed(2))*30/100;\n    data.paymentInstallments = 5;\n  }else if(month == 9){\n    value = (parseFloat(data.totalAmount).toFixed(2))*35/100;\n    data.paymentInstallments = 4;\n  } else if(month == 10){\n    value = (parseFloat(data.totalAmount).toFixed(2))*40/100;\n    data.paymentInstallments = 3;\n  } else {\n    value = parseFloat(data.totalAmount).toFixed(2);\n    data.paymentInstallments = 0;\n  }\n} else {\nvalue = parseFloat(data.totalAmount).toFixed(2);\ndata.paymentInstallments = 0;\n}",
				"key": "amountPayable",
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"label": "amount",
				"calculateValue": "value = data.totalAmount",
				"key": "amount",
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"label": "transaction_reference_number",
				"key": "transaction_reference_number",
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"label": "payment_fields",
				"calculateValue": "value = JSON.stringify({\"description\":data.business_padi,\"product\":data.product,\"state\":data.state,\"automatic_renewal\":data.automatic_renewal,\"installment_billing\":data.premiumFinance,\"policy_type\":\"New\",\"installment_amount\":0,\"downpayment_amount\":data.downPayment,\"total_amount\":data.finalAmountPayable});",
				"key": "payment_fields",
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"label": "Columns",
				"columns": [{
					"components": [{
						"label": "Final Amount Payable",
						"prefix": "$",
						"mask": false,
						"spellcheck": false,
						"disabled": true,
						"tableView": false,
						"delimiter": true,
						"requireDecimal": true,
						"inputFormat": "plain",
						"calculateValue": "value = data.amount.toFixed(2)",
						"key": "finalAmountPayable",
						"type": "number",
						"decimalLimit": 2,
						"input": true,
						"inputType": "text",
						"hideOnChildrenHidden": false
					}, {
						"label": "Would you like to apply for Premium Finance?",
						"optionsLabelPosition": "right",
						"inline": false,
						"tableView": false,
						"values": [{
							"label": "Yes",
							"value": "yes",
							"shortcut": ""
						}, {
							"label": "No",
							"value": "no",
							"shortcut": ""
						}],
						"clearOnHide": false,
						"validate": {
							"required": true
						},
						"key": "premiumFinanceSelect",
						"type": "radio",
						"input": true,
						"hideOnChildrenHidden": false
					}, {
						"label": "billing_amount",
						"calculateValue": "if(data.premiumFinanceSelect == 'yes'){\n    value = (parseFloat(data.downPayment)||0).toFixed(2);\n} else {\n  value = (parseFloat(data.amountPayable)||0).toFixed(2);\n}",
						"key": "billing_amount",
						"type": "hidden",
						"input": true,
						"tableView": false,
						"hideOnChildrenHidden": false
					}, {
						"title": "Premium Finance",
						"theme": "primary",
						"collapsible": false,
						"tableView": false,
						"key": "premiumFinance",
						"conditional": {
							"show": true,
							"when": "premiumFinanceSelect",
							"eq": "yes"
						},
						"type": "panel",
						"label": "Panel",
						"input": false,
						"components": [{
							"label": "Downpayment Deposit Percentge",
							"mask": false,
							"spellcheck": true,
							"tableView": false,
							"defaultValue": 25,
							"delimiter": false,
							"requireDecimal": false,
							"inputFormat": "plain",
							"validate": {
								"min": 25,
								"max": 100
							},
							"key": "downpaymentDepositPercentge",
							"type": "number",
							"input": true
						}, {
							"label": "Down Payment",
							"prefix": "$",
							"mask": false,
							"spellcheck": false,
							"tableView": false,
							"delimiter": false,
							"requireDecimal": false,
							"inputFormat": "plain",
							"clearOnHide": false,
							"calculateValue": "if(data.downpaymentDepositPercentge){\n  var downpaymentVal = data['downpaymentDepositPercentge'] * parseFloat(data['amount']);\n  value = (downpaymentVal/100).toFixed(2);\n} else {\n  value =0;\n}",
							"allowCalculateOverride": true,
							"key": "downPayment",
							"type": "number",
							"input": true,
							"hideOnChildrenHidden": false
						}],
						"hideOnChildrenHidden": false
					}, {
						"label": "Payment Options",
						"optionsLabelPosition": "right",
						"inline": false,
						"tableView": false,
						"values": [{
							"label": "Money Order",
							"value": "moneyOrder",
							"shortcut": ""
						}, {
							"label": "Check",
							"value": "check",
							"shortcut": ""
						}, {
							"label": "Credit Card",
							"value": "creditCard",
							"shortcut": ""
						}, {
							"label": "Other",
							"value": "other",
							"shortcut": ""
						}],
						"clearOnHide": false,
						"validate": {
							"required": true,
							"custom": "if(data.paymentOptions == \"creditCard\" && data.privileges && data.privileges['MANAGE_MY_POLICY_READ']){\n  if(document.getElementsByClassName(\"btn-wizard-nav-submit\")[0]){\n    document.getElementsByClassName(\"btn-wizard-nav-submit\")[0].style.display = \"none\";\n  }else{\n    document.getElementsByClassName(\"btn-wizard-nav-submit\")[0].style.display = \"block\";\n  }\n}else{\n  document.getElementsByClassName(\"btn-wizard-nav-submit\")[0].style.display = \"block\";\n}"
						},
						"key": "paymentOptions",
						"properties": {
							"render": "columns"
						},
						"logic": [{
							"name": "Disable on Installment Payment",
							"trigger": {
								"type": "simple",
								"simple": {
									"when": "premiumFinanceSelect",
									"eq": "yes",
									"show": true
								}
							},
							"actions": [{
								"name": "Select Credit Card",
								"type": "value",
								"value": "return \"creditCard\""
							}, {
								"name": "Disable Options",
								"type": "property",
								"property": {
									"label": "Disabled",
									"value": "disabled",
									"type": "boolean"
								},
								"state": true
							}]
						}, {
							"name": "Enable on Premium Finance",
							"trigger": {
								"type": "simple",
								"simple": {
									"when": "premiumFinanceSelect",
									"eq": "no",
									"show": true
								}
							},
							"actions": [{
								"name": "Enable All fields",
								"type": "property",
								"property": {
									"label": "Disabled",
									"value": "disabled",
									"type": "boolean"
								},
								"state": false
							}]
						}],
						"type": "radio",
						"input": true,
						"hideOnChildrenHidden": false
					}],
					"width": 6,
					"offset": 0,
					"push": 0,
					"pull": 0,
					"size": "md"
				}, {
					"components": [{
						"title": "Check Details",
						"theme": "primary",
						"collapsible": false,
						"tableView": false,
						"key": "checkDetails",
						"conditional": {
							"show": true,
							"when": "paymentOptions",
							"eq": "check"
						},
						"type": "panel",
						"label": "Check Details",
						"input": false,
						"components": [{
							"label": "Check Number",
							"mask": false,
							"spellcheck": true,
							"tableView": false,
							"delimiter": false,
							"requireDecimal": false,
							"inputFormat": "plain",
							"clearOnHide": false,
							"key": "chequeNumber",
							"type": "number",
							"input": true,
							"hideOnChildrenHidden": false
						}, {
							"label": "Miscellaneous Attachment",
							"tableView": false,
							"storage": "url",
							"webcam": true,
							"fileTypes": [{
								"label": "",
								"value": ""
							}],
							"clearOnHide": false,
							"key": "chequeConsentForm",
							"type": "file",
							"url": "/file/attachment",
							"input": true
						}],
						"hideOnChildrenHidden": false
					}, {
						"title": "Card Details",
						"theme": "primary",
						"collapsible": false,
						"tableView": false,
						"key": "cardDetails",
						"conditional": {
							"show": true,
							"when": "paymentOptions",
							"eq": "creditCard"
						},
						"type": "panel",
						"label": "Card Details",
						"input": false,
						"components": [{
							"label": "Transaction Reference Number",
							"spellcheck": false,
							"disabled": true,
							"tableView": false,
							"clearOnHide": false,
							"calculateValue": "value = data.transaction_reference_number",
							"key": "transactionReferenceNumber",
							"customConditional": "if (data.privileges['MANAGE_POLICY_APPROVAL_WRITE'] !== null && data.privileges['MANAGE_POLICY_APPROVAL_WRITE']){\n  show = true;\n} else {\n  show = false;\n}",
							"type": "textfield",
							"input": true
						}, {
							"type": "convergepay",
							"key": "creditcardPayment",
							"amount_field": "billing_amount",
							"refreshOn": "data",
							"description": "payment_fields",
							"label": "custom",
							"input": true,
							"tableView": false,
							"hideOnChildrenHidden": false
						}, {
							"label": "Content",
							"attrs": [{
								"value": "",
								"attr": ""
							}],
							"content": "</br><b><font color=\"red\">If you click \"Confirm Order\", your credit card will be charged for the amount shown above.</b></font>",
							"refreshOnChange": false,
							"tableView": false,
							"key": "page7Content",
							"conditional": {
								"show": true,
								"when": "paymentOptions",
								"eq": "creditCard"
							},
							"type": "htmlelement",
							"input": false,
							"hideLabel": true,
							"hideOnChildrenHidden": false
						}],
						"hideOnChildrenHidden": false
					}, {
						"title": "Money Order Details",
						"theme": "primary",
						"collapsible": false,
						"tableView": false,
						"key": "moneyOrderDetai",
						"conditional": {
							"show": true,
							"when": "paymentOptions",
							"eq": "moneyOrder"
						},
						"type": "panel",
						"label": "Money Order Details",
						"input": false,
						"hideOnChildrenHidden": false,
						"components": [{
							"label": "Order ID",
							"tableView": true,
							"clearOnHide": false,
							"key": "orderId",
							"type": "textfield",
							"input": true,
							"hideOnChildrenHidden": false
						}]
					}],
					"width": 6,
					"offset": 0,
					"push": 0,
					"pull": 0,
					"size": "md"
				}],
				"tableView": false,
				"key": "columns",
				"properties": {
					"payment_confirmation_page": "true"
				},
				"type": "columns",
				"input": false
			}, {
				"input": true,
				"tableView": true,
				"key": "transaction_id",
				"label": "transaction_id",
				"type": "hidden",
				"lockKey": true
			}, {
				"input": true,
				"tableView": true,
				"key": "transaction_status",
				"label": "transaction_status",
				"type": "hidden",
				"lockKey": true
			}],
			"input": false,
			"lockKey": true,
			"breadcrumbClickable": true
		}, {
			"title": "Payment Approval",
			"theme": "primary",
			"breadcrumbClickable": true,
			"buttonSettings": {
				"previous": true,
				"cancel": true,
				"next": true
			},
			"collapsible": false,
			"tableView": false,
			"key": "paymentApprovalPage",
			"customConditional": "if (data.privileges){\n  show = (data.privileges['MANAGE_POLICY_APPROVAL_WRITE'] !== null && data.privileges['MANAGE_POLICY_APPROVAL_WRITE']) ? true: false;\n}\nelse{\n  show = false;\n}",
			"type": "panel",
			"label": "Panel",
			"input": false,
			"components": [{
				"label": "Amount Recieved",
				"prefix": "$",
				"mask": false,
				"spellcheck": true,
				"tableView": false,
				"delimiter": true,
				"requireDecimal": true,
				"inputFormat": "plain",
				"clearOnHide": false,
				"key": "paymentRecieved",
				"type": "number",
				"decimalLimit": 2,
				"input": true,
				"hideOnChildrenHidden": false
			}, {
				"label": "Amount Pending",
				"prefix": "$",
				"mask": false,
				"spellcheck": true,
				"tableView": false,
				"delimiter": true,
				"requireDecimal": true,
				"inputFormat": "plain",
				"key": "amountPending",
				"type": "number",
				"decimalLimit": 2,
				"input": true,
				"hideOnChildrenHidden": false
			}, {
				"label": "Payment Verified",
				"optionsLabelPosition": "right",
				"inline": true,
				"tableView": false,
				"values": [{
					"label": "Approved",
					"value": "approved",
					"shortcut": ""
				}, {
					"label": "Declined",
					"value": "declined",
					"shortcut": ""
				}],
				"clearOnHide": false,
				"validate": {
					"required": true
				},
				"key": "paymentVerified",
				"type": "radio",
				"input": true
			}, {
				"label": "Notes",
				"autoExpand": false,
				"tableView": true,
				"key": "notes",
				"type": "textarea",
				"input": true
			}]
		}],
		"path": "page5Panel"
	}, {
		"title": "Documents Preview",
		"theme": "primary",
		"breadcrumbClickable": true,
		"buttonSettings": {
			"previous": true,
			"cancel": true,
			"next": true
		},
		"collapsible": false,
		"tableView": false,
		"key": "documentsPreview",
		"properties": {
			"commands": "[{\"command\" : \"delegate\",\"delegate\":\"StorePreviewDocument\"}]"
		},
		"customConditional": "if (data.privileges){\n  show = (data.privileges['MANAGE_POLICY_APPROVAL_WRITE'] !== null && data.privileges['MANAGE_POLICY_APPROVAL_WRITE']) ? true: false;\n}\nelse{\n  show = false;\n}",
		"type": "panel",
		"label": "Documents Preview",
		"input": false,
		"components": [{
			"title": "Document Preview",
			"theme": "primary",
			"breadcrumbClickable": true,
			"buttonSettings": {
				"previous": true,
				"cancel": true,
				"next": true
			},
			"collapsible": false,
			"tableView": false,
			"key": "page10",
			"type": "panel",
			"label": "Document Preview",
			"input": false,
			"components": [{
				"label": "finalDocuments",
				"persistent": false,
				"protected": true,
				"calculateValue": "value = {};\nif(data.finalDocuments){\n  if(typeof data.finalDocuments === 'object'){\n    value = data.finalDocuments;  \n  }else{\n    var documents = {};\n    data.finalDocuments.map(item,key => {\n      finalDocuments[key] = item;\n    });\n    value = finalDocuments;\n  }\n}",
				"key": "finalDocuments",
				"properties": {
					"data_type": "list"
				},
				"type": "hidden",
				"input": true,
				"tableView": false
			}, {
				"type": "documentviewer",
				"key": "documents1",
				"label": "Policy Documents",
				"calculateValue": "value = (data['finalDocuments'])",
				"hideLabel": true,
				"inputType": "documentviewer",
				"input": 1,
				"refreshOn": "finalDocuments",
				"tableView": false,
				"protected": true,
				"persistent": false
			}],
			"hideOnChildrenHidden": false
		}, {
			"label": "CSR Mail Documents",
			"redrawOn": "finalDocuments",
			"calculateValue": "value = \"\";",
			"key": "csrmailDocuments",
			"type": "hidden",
			"input": true,
			"tableView": false
		}]
	}, {
		"label": "Submit",
		"showValidations": false,
		"tableView": false,
		"key": "submit",
		"type": "button",
		"event": "submitForm",
		"input": true
	}],
	"controller": "data.functions = {\n  userApprovedChanged: () => {\n    if(data.userApproved == 'rejected' && (data.proposalCountFlag == false || data.proposalCountFlag == \"false\")){\n      data.proposalCount = (data.proposalCount == \"\") ? 0 : data.proposalCount;\n      data.proposalCount = parseInt(data.proposalCount) + 1;\n      data.proposalCountFlag = true;\n    }\n  },\n  paymentVerifiedChanged: () => {\n    if(data.paymentVerified == 'declined' && (data.proposalCountFlag == false || data.proposalCountFlag == \"false\")){\n      data.proposalCount = (data.proposalCount == \"\") ? 0 : data.proposalCount;\n      data.proposalCount = parseInt(data.proposalCount) + 1;\n      data.proposalCountFlag = true;\n    }\n  }\n};",
	"revisions": "current",
	"_vid": 101,
	"title": "Dive Store User Approval Form",
	"display": "wizard",
	"access": [{
		"roles": ["5ce43aa430776b950569301d", "5ce43aa430776b4a5969301e", "5ce43aa430776bdfb569301f"],
		"type": "read_all"
	}],
	"submissionAccess": [],
	"settings": {},
	"properties": {
		"submission_commands": "[{\"command\" : \"submitWorkflow\"}]",
		"commands": "[{\"command\" : \"delegate\",\"delegate\" : \"RateCard\"}]"
	},
	"name": "diveStoreUserApprovalForm",
	"path": "divestoreuserapprovalform",
	"project": "5ce43aa430776b2aff69301c",
	"created": "2020-02-05T11:46:51.316Z",
	"modified": "2020-11-27T11:52:48.445Z",
	"machineName": "testdivehub:diveStoreUserApprovalForm"
}