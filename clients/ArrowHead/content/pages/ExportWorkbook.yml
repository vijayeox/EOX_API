name: 'Export Workbooks'
description: 'Allows agents to export workbooks'
content:
    -
        type: List
        content:
            route: 'file'
            refreshInterval: 10
            defaultFilters: 
                filter:
                    logic: or
                    filters:
                        - 
                            field: status
                            operator: eq
                            value: Processing
                        - 
                            field: status
                            operator: eq
                            value: Queued
                        - 
                            field: status
                            operator: eq
                            value: Generated
                sort:
                    -
                        field: date_modified
                        dir: desc     
            resizable: true
            pageable:
                buttonCount: 3
                pageSizes:
                    - 10
                    - 20
                    - 50
                info: true
            actions:
                -
                    name: 'Please Wait'
                    rule: '''{{status}}'' == ''Processing'' || ''{{status}}'' == ''Queued'''
                    icon: 'fad fa-circle-notch fa-spin'
                -
                    name: 'Export'
                    rule: '''{{status}}'' == ''Generated'''
                    icon: 'far fa-file-download'
                    details:
                        -
                            type: Document
                            content: '<h4>Producer Name: {data.producername} </h4>
                                    <p> Producer Date : {moment(data.producerdate).format("MMMM Do YYYY")}</p>'
                            useRowData: true
                        -
                            type: DocumentViewer
                            url: 'file/{{uuid}}/document'
            toolbarTemplate: '<h5>List of completed workbooks</h5>'
            columnConfig:
                -
                    title: Insured
                    field: namedInsured
                -
                    title: 'Producer'
                    field: producername
                -
                    title: 'Effective Date'
                    field: effectiveDate
                    cell: '<td>{moment(item.effectiveDate).format("MMMM Do YYYY")}</td>'
                    filter: date
                    filterFormat: YYYY-MM-DD
                -
                    title: 'Producer Date'
                    field: producerdate
                    cell: '<td>{moment(item.producerdate).format("MMMM Do YYYY")}</td>'
                    filter: date
                    filterFormat: YYYY-MM-DD
                -
                    title: 'Status'
                    field: status